<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
This module contains the toplevel function
to solve sudoku grids as well as its' sub functions.

This implementation is deprecated (faster implementation can be found in 'SudokuSolver.solve')
and is only included for historical purpose.
-}</span><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Attempt4</span><span> </span><span class="hs-special">(</span><span> </span><a href="Attempt4.html#solve"><span class="hs-identifier hs-var">solve</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="SudokuBase.html"><span class="hs-identifier">SudokuBase</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="SudokuBase.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span class="hs-special">,</span><span> </span><a href="SudokuBase.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span class="hs-special">,</span><span> </span><a href="SudokuBase.html#Choices"><span class="hs-identifier hs-type">Choices</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="SudokuAnalize.html"><span class="hs-identifier">SudokuAnalize</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="SudokuAnalize.html#blocked"><span class="hs-identifier hs-var">blocked</span></a><span class="hs-special">,</span><span> </span><a href="SudokuAnalize.html#complete"><span class="hs-identifier hs-var">complete</span></a><span class="hs-special">,</span><span> </span><a href="SudokuAnalize.html#single"><span class="hs-identifier hs-var">single</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="SudokuTransform.html"><span class="hs-identifier">SudokuTransform</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="SudokuTransform.html#collapse"><span class="hs-identifier hs-var">collapse</span></a><span class="hs-special">,</span><span> </span><a href="SudokuTransform.html#prune"><span class="hs-identifier hs-var">prune</span></a><span class="hs-special">,</span><span> </span><a href="SudokuTransform.html#choices"><span class="hs-identifier hs-var">choices</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-- | Tries to find a solution to a specified 'Grid'</span><span>
</span><a name="line-16"></a><span class="hs-identifier">solve</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SudokuBase.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span>   </span><span class="hs-comment">-- ^ (unsolved) 'Grid' as input</span><span>
</span><a name="line-17"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SudokuBase.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list whicht eigher contains a solution or is empty</span><span>
</span><a name="line-18"></a><a name="solve"><a href="Attempt4.html#solve"><span class="hs-identifier">solve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Attempt4.html#search"><span class="hs-identifier hs-var">search</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SudokuTransform.html#prune"><span class="hs-identifier hs-var">prune</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SudokuTransform.html#choices"><span class="hs-identifier hs-var">choices</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">--------------------------------------------------------</span><span>
</span><a name="line-21"></a><span class="hs-comment">--------------------- Helper Funcs ---------------------</span><span>
</span><a name="line-22"></a><span class="hs-comment">--------------------------------------------------------</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- only search if not blocked or not complete</span><span>
</span><a name="line-25"></a><span class="hs-identifier">search</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SudokuBase.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="SudokuBase.html#Choices"><span class="hs-identifier hs-type">Choices</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SudokuBase.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span class="hs-special">]</span><span>
</span><a name="line-26"></a><a name="search"><a href="Attempt4.html#search"><span class="hs-identifier">search</span></a></a><span> </span><a name="local-6989586621679034168"><a href="#local-6989586621679034168"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SudokuAnalize.html#blocked"><span class="hs-identifier hs-var">blocked</span></a><span> </span><a href="#local-6989586621679034168"><span class="hs-identifier hs-var">m</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-27"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="SudokuAnalize.html#complete"><span class="hs-identifier hs-var">complete</span></a><span> </span><a href="#local-6989586621679034168"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SudokuTransform.html#collapse"><span class="hs-identifier hs-var">collapse</span></a><span> </span><a href="#local-6989586621679034168"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-28"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034170"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679034169"><a href="#local-6989586621679034169"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Attempt4.html#expand"><span class="hs-identifier hs-var">expand</span></a><span> </span><a href="#local-6989586621679034168"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679034170"><a href="#local-6989586621679034170"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Attempt4.html#search"><span class="hs-identifier hs-var">search</span></a><span> </span><span class="hs-special">(</span><a href="SudokuTransform.html#prune"><span class="hs-identifier hs-var">prune</span></a><span> </span><a href="#local-6989586621679034169"><span class="hs-identifier hs-var">m'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- expand the first field with multiple choices (not all multiple choice fields)</span><span>
</span><a name="line-31"></a><span class="hs-identifier">expand</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SudokuBase.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="SudokuBase.html#Choices"><span class="hs-identifier hs-type">Choices</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SudokuBase.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="SudokuBase.html#Choices"><span class="hs-identifier hs-type">Choices</span></a><span class="hs-special">]</span><span>
</span><a name="line-32"></a><a name="expand"><a href="Attempt4.html#expand"><span class="hs-identifier">expand</span></a></a><span> </span><a name="local-6989586621679034171"><a href="#local-6989586621679034171"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034172"><span class="hs-identifier hs-var">rows1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034175"><span class="hs-identifier hs-var">row1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034178"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679034177"><span class="hs-identifier hs-var">row2</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679034174"><span class="hs-identifier hs-var">rows2</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679034178"><a href="#local-6989586621679034178"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679034176"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">]</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679034172"><a href="#local-6989586621679034172"><span class="hs-identifier">rows1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679034173"><a href="#local-6989586621679034173"><span class="hs-identifier">row</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679034174"><a href="#local-6989586621679034174"><span class="hs-identifier">rows2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SudokuAnalize.html#single"><span class="hs-identifier hs-var">single</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679034171"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-34"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679034175"><a href="#local-6989586621679034175"><span class="hs-identifier">row1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679034176"><a href="#local-6989586621679034176"><span class="hs-identifier">cs</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679034177"><a href="#local-6989586621679034177"><span class="hs-identifier">row2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SudokuAnalize.html#single"><span class="hs-identifier hs-var">single</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679034173"><span class="hs-identifier hs-var">row</span></a><span>
</span><a name="line-35"></a></pre></body></html>